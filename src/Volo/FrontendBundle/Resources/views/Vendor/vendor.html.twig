{% extends 'VoloFrontendBundle:Layout:page.html.twig' %}

{% block content_wrapper_class %}menu-bg{% endblock content_wrapper_class %}
{% block body_class %}menu-page{% endblock %}

{% block footer_scripts %}
    {{ parent() }}

    <script data-turbolinks-eval=always>
        var VOLO = VOLO || {};
        VOLO.jsonCart = {{ cart|to_escaped_json}};
    </script>
{% endblock %}

{% block content %}
<div class="top-cart">
    <div class="top-cart__info">
        <h3>Restaurant name</h3>
    </div>
    <div class="top-cart__extra-fee">
        Delivery fee added to your final order  <span>{{ "5.00"|price }}</span>
    </div>
</div>
<div class="hero-banner-wrapper">
    {% include 'VoloFrontendBundle:Layout/ImageTag:thumbor_image_background.html.twig' with {type: 'hero', 'vendorCode' : vendor.code, 'aspectRatioClass' : 'aspect-ratio-40-11'} %}
    <div class="hero-menu__info">
        <h2>{{ vendor.name }} <span>{{ vendor.description|lower }}</span></h2>
        {% set closingInMinutes = getClosingIn(vendor.schedules) %}
        <p>
            {% if (closingInMinutes <= 0) %}
                <span class="line-wrapper">{{ 'vendor_closed_preorder_available'|trans }}</span>
                <span>{{ getNextOpeningWeekDayNumber(vendor.schedules)|dayOfTheWeek }}
                {{ getNextOpeningHours(vendor.schedules)|formatTime }} - {{ getNextClosingHours(vendor.schedules)|formatTime }}</span>
            {% elseif (closingInMinutes < 60) %}
                <span class="line-wrapper">Closing in {{ closingInMinutes }} min.</span>
                <span>{{ getNextOpeningWeekDayNumber(vendor.schedules)|dayOfTheWeek }}
                {{ getNextOpeningHours(vendor.schedules)|formatTime }} - {{ getNextClosingHours(vendor.schedules)|formatTime }}</span>
            {% else %}
                <span class="green-class">Open</span>
                <span>{{ getOpeningTime(vendor.schedules)|formatTime }} â€“ {{ getClosingTime(vendor.schedules)|formatTime }}</span>
            {% endif %}
        </p>
    </div>
    <div class="hero-menu__info-extra">
        {% if ('' != vendor.address) %}
            <i class="icon-pin-map"></i> {{ vendor.address }}
        {% endif %}
        {% if ('' != vendor.customerPhone) %}
        <i class="icon-call-phone"></i> {{ vendor.customerPhone }}
        {% endif %}
    </div>
</div>
<div class="menu-wrapper">
    <div class="menu">
        <div class="menu__main" data-vendor_id="{{ vendor.id }}" >
            <div class="menu__main__list">
                {{ include('VoloFrontendBundle:Vendor:allergyLegend.html.twig') }}
                <div class="menu__categories">
                    <div class="b-lazy aspect-ratio-117-45 menu__vendor-logo" data-src="{{ vendor.logo|prepareLogoUrl(logo_image_dimensions) }}">
                    </div>
                    <nav>
                        <ul>
                            {% for menuCategory in vendor.menus.first.menuCategories %}
                                <li>
                                    <a class="anchorNavigation" data-id="{{ menuCategory.id }}" href="#menu__category-id-{{ menuCategory.id }}">
                                        {{ menuCategory.name }}
                                    </a>
                                </li>
                            {% endfor %}
                        </ul>
                    </nav>
                </div>
                <div class="menu__items">
                    {% for menuCategory in vendor.menus.first.menuCategories %}
                        <h3 class="menu__items__title" id="menu__category-id-{{ menuCategory.id }}">{{ menuCategory.name }}</h3>
                        {% for product in menuCategory.products %}
                            {# ------ Please toggle "menu__item--selected" class on click to style selected item  #}
                            <div class="menu__item" data-object='{{ serialize(product) }}'>
                                <div class="menu__item__wrapper">
                                    <div class="menu__item__name">
                                        {{ product.name }}
                                        {% if product.productVariations.first.name %}
                                            <a href="#" class="btn-allergy">
                                                <sup>{{ product.productVariations.first.name }}</sup>
                                            </a>
                                        {% endif %}
                                    </div>
                                    <div class="menu__item__description">
                                        {{ product.description }}
                                    </div>
                                </div>
                                <div class="menu__item__price">
                                    {{ product.productVariations.first.price|price }}
                                    <button class="menu__item__add"><i class="icon-plus"></i></button>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                        {% endfor %}
                    {% endfor %}

                </div>
            </div>
        </div>
        <div class="desktop-cart" data-minimum_order_amount="{{ vendor.minimumOrderAmount}}" data-vendor_id="{{ vendor.id }}">{# cart from template#}</div>
    </div>
    <div class="menu__bottom-info">
        <div class="menu__bottom-info__openings">
            <h3 class="menu__bottom-info__title">Opening hours</h3>
            <ul>
                {% for weekdayIndex in 1..7 %}
                    {% set openingTime = getOpeningTime(vendor.schedules, weekdayIndex) %}
                    {% if (null != openingTime) %}
                        <li>
                            {{ weekdayIndex|dayOfTheWeek }} <span>{{ openingTime|formatTime }} - {{ getClosingTime(vendor.schedules, weekdayIndex)|formatTime }}</span>
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
        <div class="menu__bottom-info__seo">
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium alias aut dolorem earum fugit ipsa maxime modi nam officia optio, pariatur perferendis porro quae quaerat reiciendis, saepe sed totam, voluptates.  Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusantium alias aut dolorem earum fugit ipsa maxime modi nam officia optio, pariatur perferendis porro quae quaerat reiciendis, saepe sed totam, voluptates.
        </div>
    </div>
</div>
<div class="bottom-cart">
    <div class="bottom-cart__wrapper">
        <div class="bottom-cart__quantity"><span>23</span></div>
        <div class="bottom-cart__cta">{{ 'view_this_cart'|trans }}</div>
        <div class="bottom-cart__price">{{ "131.50"|price }}</div>
    </div>
</div>

    {{ include('VoloFrontendBundle:Layout/Partial/templates:cart.html.twig') }}
    {{ include('VoloFrontendBundle:Layout/Partial/templates:toppings.html.twig') }}
    {{ include('VoloFrontendBundle:Layout/Partial/templates/popups:vendor.html.twig') }}

{% endblock %}
