{% block head_scripts %}
    <script src="https://maps.googleapis.com/maps/api/js?v=3.2&amp;sensor=false&amp;libraries=places&amp;language={{ locale|replace('_', '-') }}&amp;client={{ google_api_client_id }}&amp;channel={{ google_api_channel }}"></script>
    {% if app.debug == true %}
        <script src="{{ asset('js/dist/libs.js') }}"></script>
        <script src="{{ asset('js/dist/head.js') }}"></script>
        <script src="{{ path('thumbor_configuration') }}"></script>
    {% else %}
        <script src="{{ asset('js/dist/dist.js') }}"></script>
    {% endif %}

    <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}&{{ assets_version }}"></script>

    <script type="text/javascript">
        var VOLO = VOLO || {};
        VOLO.tagManager = {};
        VOLO.tagManager.referrer = '{{ gtm_get_referrer() }}';
        VOLO.tagManager.pageType = '';

        VOLO.Translations = {
            home: {
                postal_index_form_please_select_option: '{{ 'home.postal_index_form_please_select_option'|trans|e }}'
            }
        };
        VOLO.configuration = VOLO.configuration || {};
        VOLO.configuration.countryCode = '{{ country_code }}';
        VOLO.configuration.locale = '{{ locale }}';
        VOLO.configuration.address_config = {{ address_config|to_escaped_json }}
        VOLO.configuration.sessionId = '{{ app.session.id }}';
        VOLO.configuration.googleTagManagerContainerId = '{{ google_tag_manager_container_id }}';
        VOLO.configuration.appVersion = '{{ app_version }}';
        VOLO.orderTrackingInterval = null;
        VOLO.configuration.smallScreenMaxSize = 800;
        VOLO.configuration.anchorScrollSpeed = 500;

        // cart layout and animation
        VOLO.configuration.cartBottomMargin = 50;
        VOLO.configuration.itemsOverflowingClassName = 'checkout__summary-overflowing';
        VOLO.configuration.timeZone = '{{ timezone }}';
        VOLO.configuration.currencySymbol = '{{ get_currency_symbol_iso() }}';
        VOLO.configuration.averageDeliveryTime = '{{ average_delivery_time }}';

        VOLO.configuration.minimum_order_value_setting = '{{ get_minimum_order_value_setting() }}';

        dataLayer = [];

        VOLO.jsonLocation = {{ customer_location()|to_escaped_json }};
        {% if is_customer_authenticated_fully() %}
            {% set customer = serialize(get_authenticated_customer()) %}
            {% set isGuest = 'false' %}
        {% else %}
            {% set customer = get_guest_customer(app.request.session)|to_escaped_json %}
            {% set isGuest = 'true' %}
        {% endif %}
        VOLO.createCustomerModel({{ customer|raw }}, {{ isGuest }});
        VOLO.defaultCartValues = {{ get_default_cart_values(app.session)|to_escaped_json }};
    </script>

    <!-- BEGIN TRACKJS -->
    <script type="text/javascript">
        window._trackJs = {
            token: '{{ trackjs_token }}',
            application: '{{ trackjs_application }}',
            enabled: {{ (app.debug == false)|json_encode }},
            userId: '{{ get_authenticated_customer().id|default('anonymous') }}',
            sessionId: '{{ app.request.session.id }}',
            onError: function (payload, error) {
                if (typeof error === 'string') {
                    if (null !== error.match('^400 Bad Request:')) {
                        return false
                    }
                    if (null !== error.match('^412 Precondition Failed:')) {
                        return false
                    }
                }

                return true;
            }
        };
    </script>
    <script type="text/javascript" src="https://d2zah9y47r7bi2.cloudfront.net/releases/current/tracker.js"></script>
    <!-- END TRACKJS -->
{% endblock %}
